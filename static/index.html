<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MiChat</title>
<style>
body { font-family: sans-serif; background: #121212; color: #fff; }
#chat { border: 1px solid #555; height: 400px; overflow-y: scroll; padding: 10px; }
.timestamp { font-size: 0.8em; color: gray; margin-left: 5px; }
input, button { padding: 5px; }
</style>
</head>
<body>
<h1>MiChat</h1>
<div id="chat"></div>
<input id="username" placeholder="Name">
<input id="color" type="color" value="#00ff00">
<input id="message" placeholder="Nachricht">
<button onclick="sendMessage()">Senden</button>

<script>
const chatContainer = document.getElementById("chat");
const ws = new WebSocket(`ws://${location.host}/ws`);

ws.onmessage = (event) => {
    const msg = JSON.parse(event.data);
    const time = new Date(msg.timestamp);
    const formattedTime = time.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
    const div = document.createElement("div");
    div.innerHTML = `<span style="color:${msg.color || '#fff'}">${msg.username}</span>: ${msg.content} <span class="timestamp">${formattedTime}</span>`;
    chatContainer.appendChild(div);
    chatContainer.scrollTop = chatContainer.scrollHeight;
};

function sendMessage(){
    const username = document.getElementById("username").value || "Anonymous";
    const message = document.getElementById("message").value;
    const color = document.getElementById("color").value;
    if(message.trim() === "") return;
    ws.send(JSON.stringify({username, content: message, color}));
    document.getElementById("message").value = "";
}
</script>
</body>
</html>
